
pool:
  vmImage: 'windows-latest'

name: $(Release)$(Rev:.r)

steps:
  - task: DownloadGitHubRelease@0
    inputs:
      connection: 'captncraig'
      userRepository: 'StackExchange/dnscontrol'
      defaultVersionType: "v$(Release)"
      itemPattern: 'dnscontrol.exe'
      downloadPath: '.'
  - script: "ls -la"
  - script: "choco pack --version=$(Release) --outdir=$(Build.ArtifactStagingDirectory)"
  - script: "ls -la $(Build.ArtifactStagingDirectory)"
  - task: PublishBuildArtifacts@1
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)'
      ArtifactName: 'nupkg'
      publishLocation: 'Container'